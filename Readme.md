Derived from Socket.IO chat example.